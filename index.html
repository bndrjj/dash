<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>لوحة متابعة دعم التميز المدرسي</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0f3d3e;
            --secondary: #1f6f78;
            --accent: #2b8a9b;
            --accent-light: #e2f1f3;
            --bg: #f5f7f9;
            --card: #ffffff;
            --text: #0b2c2f;
            --muted: #5c6f73;
            --border: #d7e3e5;
            --shadow: rgba(15, 61, 62, 0.08);
            --icon: #0f3d3e;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Tajawal', 'Cairo', sans-serif;
            background: var(--bg);
            color: var(--text);
        }

        h1,
        h2,
        h3,
        h4,
        .section-title {
            font-family: 'Cairo', sans-serif;
            letter-spacing: 0.2px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 32px 20px 50px;
        }

        .top-bar {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            border-radius: 16px;
            padding: 20px 28px;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
            box-shadow: 0 18px 40px var(--shadow);
        }

        .top-bar .title-group h1 {
            font-size: 1.8rem;
            margin-bottom: 0;
            font-weight: 700;
        }

        .top-bar .title-row {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 8px;
        }

        .top-bar .report-logo {
            height: 48px;
            width: auto;
            object-fit: contain;
            flex-shrink: 0;
        }

        .top-bar .title-group p {
            font-size: 1rem;
            opacity: 0.85;
        }

        .top-bar .meta {
            text-align: left;
            background: rgba(255, 255, 255, 0.15);
            padding: 12px 18px;
            border-radius: 12px;
            font-size: 0.95rem;
        }

        .filters {
            margin-top: 24px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
        }

        .classification-row {
            margin-top: 22px;
            display: grid;
            grid-template-columns: repeat(4, minmax(160px, 1fr));
            gap: 12px;
        }

        .classification-item {
            background: var(--card);
            border-radius: 14px;
            padding: 14px 16px;
            border: 1px solid var(--border);
            box-shadow: 0 10px 24px var(--shadow);
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 10px;
        }

        .classification-item span {
            color: var(--muted);
            font-size: 0.9rem;
        }

        .classification-item strong {
            font-size: 1.2rem;
            color: var(--primary);
        }

        .filter-card {
            background: var(--card);
            border-radius: 14px;
            padding: 16px 18px;
            box-shadow: 0 12px 30px var(--shadow);
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .filter-card label {
            font-size: 0.85rem;
            color: var(--muted);
            display: block;
            margin-bottom: 8px;
        }

        .filter-card select,
        .filter-card input {
            width: 100%;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 10px 12px;
            font-size: 0.95rem;
            font-family: inherit;
            background: #fff;
        }

        .stats-grid {
            margin-top: 24px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 16px;
        }

        .stat-card {
            background: var(--card);
            border-radius: 16px;
            padding: 20px 22px;
            border: 1px solid var(--border);
            box-shadow: 0 12px 30px var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .stat-card::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--accent), var(--secondary));
        }

        .stat-card h3 {
            font-size: 2.2rem;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .stat-card p {
            color: var(--muted);
            font-size: 0.95rem;
        }

        .stat-subtext {
            color: var(--muted);
            font-size: 0.8rem;
            margin-top: 6px;
        }

        .section {
            margin-top: 32px;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 16px;
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
        }

        .title-with-icon {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .title-icon {
            width: 18px;
            height: 18px;
            stroke: var(--icon);
            fill: none;
            stroke-width: 1.8;
            stroke-linecap: round;
            stroke-linejoin: round;
            flex-shrink: 0;
        }

        .section-subtitle {
            color: var(--muted);
            font-size: 0.9rem;
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: 16px;
        }

        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid var(--border);
            box-shadow: 0 12px 30px var(--shadow);
        }

        .card h4 {
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .metric-list {
            display: grid;
            gap: 10px;
        }

        .metric-row {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 12px;
            border-radius: 10px;
            background: var(--accent-light);
            font-size: 0.95rem;
        }

        .metric-row span {
            font-weight: 600;
            color: var(--primary);
        }

        .bar-list {
            display: grid;
            gap: 12px;
        }

        .bar-row {
            display: grid;
            grid-template-columns: 110px 1fr 60px;
            align-items: center;
            gap: 12px;
            font-size: 0.9rem;
        }

        .bar-track {
            background: #edf3f4;
            border-radius: 999px;
            height: 10px;
            overflow: hidden;
        }

        .bar-track span {
            display: block;
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--accent));
            border-radius: inherit;
        }

        .compliance-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
            gap: 16px;
        }

        .compliance-card {
            background: var(--card);
            border-radius: 16px;
            padding: 18px;
            border: 1px solid var(--border);
            box-shadow: 0 12px 30px var(--shadow);
        }

        .compliance-card h4 {
            font-size: calc(1rem - 5px);
            margin-bottom: 12px;
            color: var(--primary);
        }

        .compliance-values {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .badge {
            padding: 6px 10px;
            border-radius: 999px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .badge.yes { background: #dff3e4; color: #1f6f3f; }
        .badge.no { background: #fde2e2; color: #a33a3a; }
        .badge.unknown { background: #f3f0d7; color: #7d6f1b; }

        .progress {
            margin-top: 12px;
            height: 8px;
            background: #edf3f4;
            border-radius: 999px;
            overflow: hidden;
        }

        .progress span {
            display: block;
            height: 100%;
            background: linear-gradient(90deg, var(--secondary), var(--accent));
        }

        .compliance-gauge {
            margin-top: 14px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .gauge-ring {
            --value: 0;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: conic-gradient(var(--secondary) calc(var(--value) * 1%), #e8eff1 0);
            display: grid;
            place-items: center;
            position: relative;
        }

        .gauge-ring::after {
            content: '';
            position: absolute;
            width: 86px;
            height: 86px;
            border-radius: 50%;
            background: #fff;
            box-shadow: inset 0 0 0 1px rgba(15, 61, 62, 0.08);
        }

        .gauge-ring span {
            position: relative;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary);
            z-index: 1;
        }

        .gauge-caption {
            font-size: 0.85rem;
            color: var(--muted);
        }

        .footer {
            margin-top: 40px;
            text-align: center;
            color: var(--muted);
            font-size: 0.9rem;
        }

        @media (max-width: 768px) {
            .top-bar {
                flex-direction: column;
                align-items: flex-start;
            }

            .classification-row {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            }

            .bar-row {
                grid-template-columns: 1fr;
                align-items: start;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="app">
        <div class="top-bar">
            <div class="title-group">
                <h1>لوحة متابعة دعم التميز المدرسي</h1>
                <p>جاري تحميل البيانات...</p>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    <script>
        const normalizeDigits = (value) => String(value)
            .replace(/[٠-٩]/g, (digit) => '0123456789'['٠١٢٣٤٥٦٧٨٩'.indexOf(digit)])
            .replace(/[۰-۹]/g, (digit) => '0123456789'['۰۱۲۳۴۵۶۷۸۹'.indexOf(digit)]);

        const numberFormatter = new Intl.NumberFormat('en-US');

        const formatNumber = (value) => {
            const normalized = normalizeDigits(value);
            const numeric = typeof value === 'number' ? value : Number(normalized);
            return Number.isFinite(numeric) ? numberFormatter.format(numeric) : normalized;
        };

        const buildBarList = (items) => {
            const max = Math.max(...items.map(item => item.value));
            return items.map(item => {
                const width = max ? (item.value / max) * 100 : 0;
                return `
                    <div class="bar-row">
                        <span>${item.label}</span>
                        <div class="bar-track"><span style="width: ${width}%;"></span></div>
                        <strong>${formatNumber(item.value)}</strong>
                    </div>
                `;
            }).join('');
        };

        const normalizeText = (value) => String(value || '')
            .replace(/\u00a0/g, ' ')
            .replace(/\s+/g, ' ')
            .trim();

        const resolveColumnKey = (headers, target) => {
            const normalizedTarget = normalizeText(target);
            return headers.find(header => normalizeText(header) === normalizedTarget);
        };

        const resolveColumnKeys = (headers, targets) => {
            const keys = {};
            Object.entries(targets).forEach(([key, label]) => {
                keys[key] = resolveColumnKey(headers, label);
            });
            return keys;
        };

        const COLUMN_LABELS = {
            sector: 'ALLSVA',
            serviceType: 'المهمة حسب خطة المشرف التربوي',
            deliveryMode: 'نوع الخدمة9',
            schoolType: 'جميع مدارس الخدمة',
            gender: 'جميع النوع',
            stage: 'جميع المراحل',
            assignedSchool: 'جميع مدارس التكليف',
            additionalSchool: 'جميع المدارس الإضافية',
            supervisors: 'جميع المشرفين',
            supportFields: 'حدد مجالات الدعم الرئيسة التي ساهم المشرف بها خلال اليوم الدراسي',
            leadership: 'من وجهة نظرك ما مدى مشاركة مدير المدرسة واللجان المعنية في قيادة عمليات الدعم',
            classificationScore: 'مجمع دعم المدير والمدرسة رقم',
            complianceMadrasti: 'تفعّل المدرسة التعليم الالكتروني من خلال منصة مدرستي',
            complianceUniform: 'يلتزم الطلاب بلبس الزي السعودي الرسمي',
            complianceBehavior: 'تطبق المدرسة لائحة السلوك والمواظبة على الطلاب',
            complianceSchedule: 'تتم المحافظة على أوقات الحصص الدراسية',
            complianceAttendance: 'هل تم تثبيت الغياب بشكل منتظم خلال الاسبوع'
        };

        const parseNumber = (value) => {
            const numeric = Number(String(value || '').replace(/,/g, '').trim());
            return Number.isFinite(numeric) ? numeric : 0;
        };

        const computeSupervisorSummary = (rows, columns, selectedSector) => {
            if (!rows.length || !columns.sector || !columns.total) {
                return null;
            }

            const filteredRows = selectedSector === 'الكل'
                ? rows
                : rows.filter(row => normalizeText(row[columns.sector]) === normalizeText(selectedSector));

            if (!filteredRows.length) {
                return null;
            }

            return filteredRows.reduce((acc, row) => {
                acc.total += parseNumber(row[columns.total]);
                acc.male += parseNumber(row[columns.male]);
                acc.female += parseNumber(row[columns.female]);
                return acc;
            }, { total: 0, male: 0, female: 0 });
        };

        const computeSchoolSupportSummary = (rows, columns, selectedSector) => {
            if (!rows.length || !columns.sector || !columns.total) {
                return null;
            }

            const filteredRows = rows.filter(row => {
                const sectorValue = normalizeText(row[columns.sector]);
                if (!sectorValue || sectorValue === '0') {
                    return false;
                }
                if (selectedSector === 'الكل') {
                    return true;
                }
                return sectorValue === normalizeText(selectedSector);
            });

            if (!filteredRows.length) {
                return null;
            }

            return filteredRows.reduce((acc, row) => {
                acc.total += parseNumber(row[columns.total]);
                acc.male += parseNumber(row[columns.male]);
                acc.female += parseNumber(row[columns.female]);
                return acc;
            }, { total: 0, male: 0, female: 0 });
        };

        const computeAggregates = (rows, columns, selectedSector, baseData, supervisorRows, supervisorColumns, schoolSupportColumns) => {
            const filteredRows = selectedSector === 'الكل'
                ? rows
                : rows.filter(row => normalizeText(row[columns.sector]) === normalizeText(selectedSector));

            const countBy = (key) => {
                const counts = new Map();
                filteredRows.forEach(row => {
                    const value = normalizeText(row[key]);
                    if (!value) {
                        return;
                    }
                    counts.set(value, (counts.get(value) || 0) + 1);
                });
                return counts;
            };

            const collectUnique = (keys) => {
                const unique = new Set();
                filteredRows.forEach(row => {
                    keys.forEach(key => {
                        const value = normalizeText(row[key]);
                        if (value) {
                            unique.add(value);
                        }
                    });
                });
                return unique;
            };

            const serviceTypeCounts = countBy(columns.serviceType);
            const deliveryModeCounts = countBy(columns.deliveryMode);
            const schoolTypeCounts = countBy(columns.schoolType);
            const genderCounts = countBy(columns.gender);

            const stageCounts = new Map();
            const mapStageLabel = (rawStage) => {
                if (rawStage.includes(';')) {
                    return 'مجمع مدارس';
                }
                if (rawStage.includes('رياض')) {
                    return 'رياض الاطفال';
                }
                if (rawStage.includes('مهمة')) {
                    return 'مهمة عمل';
                }
                return rawStage;
            };

            filteredRows.forEach(row => {
                const rawStage = normalizeText(row[columns.stage]);
                if (!rawStage) {
                    return;
                }
                const stage = mapStageLabel(rawStage);
                stageCounts.set(stage, (stageCounts.get(stage) || 0) + 1);
            });

            const complianceFields = [
                { key: columns.complianceMadrasti, label: 'تفعيل منصة مدرستي' },
                { key: columns.complianceUniform, label: 'التزام الطلاب بالزي الرسمي' },
                { key: columns.complianceBehavior, label: 'تطبيق لائحة السلوك والمواظبة' },
                { key: columns.complianceSchedule, label: 'المحافظة على أوقات الحصص' },
                { key: columns.complianceAttendance, label: 'تثبيت الغياب في نظام نور' }
            ];

            const compliance = complianceFields.map(field => {
                let yes = 0;
                let no = 0;
                filteredRows.forEach(row => {
                    const value = normalizeText(row[field.key]);
                    if (value === 'نعم') {
                        yes += 1;
                    } else if (value === 'لا') {
                        no += 1;
                    }
                });
                const total = filteredRows.length;
                const unknown = Math.max(total - yes - no, 0);
                return { label: field.label, yes, no, unknown };
            });

            const leadershipCounts = countBy(columns.leadership);
            const leadershipItems = baseData.leadershipParticipation.map(item => ({
                label: item.label,
                value: leadershipCounts.get(normalizeText(item.label)) || 0
            }));

            const supportFieldTotals = new Map();
            const supportFieldKeys = [
                'التدريس',
                'نواتج التعلم',
                'التوجيه الطلابي',
                'النشاط الطلابي'
            ];
            filteredRows.forEach(row => {
                const rawValue = normalizeText(row[columns.supportFields]);
                if (!rawValue) {
                    return;
                }
                const parts = rawValue.split(';').map(part => normalizeText(part)).filter(Boolean);
                parts.forEach(part => {
                    const label = supportFieldKeys.includes(part) ? part : 'غير ذلك';
                    supportFieldTotals.set(label, (supportFieldTotals.get(label) || 0) + 1);
                });
            });

            const sectorCounts = countBy(columns.sector);
            const sectorDistribution = Array.from(sectorCounts.entries())
                .map(([label, value]) => ({ label, value }))
                .sort((a, b) => b.value - a.value);

            const sectors = Array.from(new Set(rows.map(row => normalizeText(row[columns.sector])).filter(Boolean)))
                .sort((a, b) => a.localeCompare(b, 'ar'));

            const uniqueSchools = collectUnique([columns.assignedSchool, columns.additionalSchool]);
            const uniqueSupervisors = collectUnique([columns.supervisors]);
            const supervisorSummary = computeSupervisorSummary(supervisorRows, supervisorColumns, selectedSector);
            const schoolSupportSummary = computeSchoolSupportSummary(supervisorRows, schoolSupportColumns, selectedSector);

            const summary = {
                totalReports: filteredRows.length,
                totalSchools: schoolSupportSummary ? schoolSupportSummary.total : uniqueSchools.size,
                totalSupervisors: supervisorSummary ? supervisorSummary.total : uniqueSupervisors.size,
                sectorCount: Array.from(new Set(filteredRows.map(row => normalizeText(row[columns.sector])).filter(Boolean))).length,
                maleSupervisors: supervisorSummary ? supervisorSummary.male : (genderCounts.get('بنين') || 0),
                femaleSupervisors: supervisorSummary ? supervisorSummary.female : (genderCounts.get('بنات') || 0),
                maleSupportedSchools: schoolSupportSummary ? schoolSupportSummary.male : 0,
                femaleSupportedSchools: schoolSupportSummary ? schoolSupportSummary.female : 0
            };

            return {
                ...baseData,
                filters: {
                    sectors,
                    selectedSector
                },
                summary,
                schoolClassification: baseData.schoolClassification,
                serviceTypes: baseData.serviceTypes.map(item => ({
                    label: item.label,
                    value: serviceTypeCounts.get(normalizeText(item.label)) || 0
                })),
                deliveryModes: baseData.deliveryModes.map(item => ({
                    label: item.label,
                    value: deliveryModeCounts.get(normalizeText(item.label)) || 0
                })),
                schoolTypes: baseData.schoolTypes.map(item => ({
                    label: item.label,
                    value: schoolTypeCounts.get(normalizeText(item.label)) || 0
                })),
                genderDistribution: baseData.genderDistribution.map(item => ({
                    label: item.label,
                    value: genderCounts.get(normalizeText(item.label)) || 0
                })),
                stageDistribution: baseData.stageDistribution.map(item => ({
                    label: item.label,
                    value: stageCounts.get(normalizeText(item.label)) || 0
                })),
                compliance,
                leadershipParticipation: leadershipItems,
                supportFields: baseData.supportFields.map(item => ({
                    label: item.label,
                    value: supportFieldTotals.get(normalizeText(item.label)) || 0
                })),
                sectorDistribution
            };
        };

        async function loadData() {
            try {
                const [jsonResponse, excelResponse] = await Promise.all([
                    fetch('data.json'),
                    fetch('الاسبوع الاول - تقرير مقدمي خدمة الدعم التميز.xlsx')
                ]);

                if (!jsonResponse.ok || !excelResponse.ok) {
                    throw new Error('فشل تحميل البيانات');
                }

                const baseData = await jsonResponse.json();
                const excelBuffer = await excelResponse.arrayBuffer();
                const workbook = XLSX.read(excelBuffer, { type: 'array' });
                const sheet = workbook.Sheets[workbook.SheetNames[0]];
                const supervisorSheet = workbook.Sheets.ALL1;
                const rows = XLSX.utils.sheet_to_json(sheet, { defval: '' });
                const headers = rows.length ? Object.keys(rows[0]) : [];
                const columns = resolveColumnKeys(headers, COLUMN_LABELS);
                const supervisorRows = supervisorSheet ? XLSX.utils.sheet_to_json(supervisorSheet, { defval: '' }) : [];
                const supervisorHeaders = supervisorRows.length ? Object.keys(supervisorRows[0]) : [];
                const supervisorColumns = resolveColumnKeys(supervisorHeaders, {
                    sector: 'قطاعات المشرفين',
                    total: 'عدد المشرفين بالقطاع',
                    male: 'عدد المشرفين بنين بالقطاع',
                    female: 'عدد المشرفين بنات بالقطاع'
                });
                const schoolSupportColumns = resolveColumnKeys(supervisorHeaders, {
                    sector: 'القطاع-عدد',
                    total: 'مجموع-بنين-بنات-عدد-شامل',
                    male: resolveColumnKey(supervisorHeaders, 'مجموع بنين-عدد')
                        || resolveColumnKey(supervisorHeaders, 'مجموع بنبن-عدد'),
                    female: 'مجموع بنات-عدد'
                });
                const selectedSector = baseData.filters?.selectedSector || 'الكل';
                const dashboardData = computeAggregates(
                    rows,
                    columns,
                    selectedSector,
                    baseData,
                    supervisorRows,
                    supervisorColumns,
                    schoolSupportColumns
                );

                renderDashboard(dashboardData, rows, columns, baseData, supervisorRows, supervisorColumns, schoolSupportColumns);
            } catch (error) {
                document.getElementById('app').innerHTML = `
                    <div class="card" style="text-align:center;">
                        <h2>⚠️ تعذر تحميل البيانات</h2>
                        <p style="margin-top:8px;">${error.message}</p>
                    </div>
                `;
            }
        }

        function renderDashboard(data, rows, columns, baseData, supervisorRows, supervisorColumns, schoolSupportColumns) {
            const app = document.getElementById('app');
            const summary = data.summary;

            const sectorOptions = ['الكل', ...data.filters.sectors]
                .map(option => `<option ${option === data.filters.selectedSector ? 'selected' : ''}>${option}</option>`)
                .join('');

            app.innerHTML = `
                <div class="top-bar">
                    <div class="title-group">
                        <div class="title-row">
                            <img class="report-logo" src="data:image/png;base64,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" alt="شعار وزارة التعليم" />
                            <h1><span>${data.header.title}</span></h1>
                        </div>
                        <p>${data.header.subtitle}</p>
                    </div>
                    <div class="meta">
                        <div>${normalizeDigits(data.header.year)}</div>
                        <div>${normalizeDigits(data.header.week)}</div>
                    </div>
                </div>

                <div class="classification-row">
                    ${data.schoolClassification.map(item => `
                        <div class="classification-item">
                            <span>${item.label}</span>
                            <strong>${formatNumber(item.value)}</strong>
                        </div>
                    `).join('')}
                </div>

                <div class="filters">
                    <div class="filter-card">
                        <label>القطاع</label>
                        <select id="sector-select">${sectorOptions}</select>
                    </div>
                    <div class="filter-card">
                        <label>الأسبوع</label>
                        <input type="text" value="${normalizeDigits(data.header.week)}" readonly />
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>${formatNumber(summary.totalReports)}</h3>
                        <p>مجموع التقارير</p>
                    </div>
                    <div class="stat-card">
                        <h3>${formatNumber(summary.totalSchools)}</h3>
                        <p>المدارس التي يقدم لها الدعم</p>
                        <div class="stat-subtext">عدد المدارس بنين - ${formatNumber(summary.maleSupportedSchools)} ، عدد المدارس بنات - ${formatNumber(summary.femaleSupportedSchools)}</div>
                    </div>
                    <div class="stat-card">
                        <h3>${formatNumber(summary.sectorCount)}</h3>
                        <p>عدد القطاعات</p>
                    </div>
                    <div class="stat-card">
                        <h3>${formatNumber(summary.totalSupervisors)}</h3>
                        <p>مقدمو الخدمة (بنين ${formatNumber(summary.maleSupervisors)} • بنات ${formatNumber(summary.femaleSupervisors)})</p>
                    </div>
                </div>

                <section class="section">
                    <div class="section-header">
                        <div>
                            <div class="section-title title-with-icon">
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M4 18h16"></path>
                                    <path d="M7 18V10"></path>
                                    <path d="M12 18V6"></path>
                                    <path d="M17 18v-4"></path>
                                </svg>
                                <span>مؤشرات الخدمة والتقارير</span>
                            </div>
                            <div class="section-subtitle">عرض تفصيلي لأنواع الخدمة والتوزيع بحسب نوع المدرسة</div>
                        </div>
                    </div>
                    <div class="cards-grid">
                        <div class="card">
                            <h4>
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M5 6h14"></path>
                                    <path d="M5 12h14"></path>
                                    <path d="M5 18h14"></path>
                                </svg>
                                <span>نوع الخدمة المقدمة</span>
                            </h4>
                            <div class="metric-list">
                                ${data.serviceTypes.map(item => `
                                    <div class="metric-row">
                                        <span>${item.label}</span>
                                        <strong>${formatNumber(item.value)}</strong>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="card">
                            <h4>
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M4 10l8-6 8 6"></path>
                                    <path d="M6 10v8h12v-8"></path>
                                    <path d="M10 18v-4h4v4"></path>
                                </svg>
                                <span>نوع المدرسة حسب التقارير</span>
                            </h4>
                            <div class="metric-list">
                                ${data.genderDistribution.map(item => `
                                    <div class="metric-row">
                                        <span>${item.label}</span>
                                        <strong>${formatNumber(item.value)}</strong>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="card">
                            <h4>
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M4 7h16"></path>
                                    <path d="M4 12h10"></path>
                                    <path d="M4 17h7"></path>
                                    <path d="M17 12l3 3"></path>
                                    <path d="M20 12l-3 3"></path>
                                </svg>
                                <span>أسلوب تقديم الخدمة</span>
                            </h4>
                            <div class="metric-list">
                                ${data.deliveryModes.map(item => `
                                    <div class="metric-row">
                                        <span>${item.label}</span>
                                        <strong>${formatNumber(item.value)}</strong>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        <div class="card">
                            <h4>
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <circle cx="6" cy="12" r="2.5"></circle>
                                    <circle cx="12" cy="7" r="2.5"></circle>
                                    <circle cx="18" cy="12" r="2.5"></circle>
                                    <path d="M6 14.5v3.5"></path>
                                    <path d="M12 9.5V18"></path>
                                    <path d="M18 14.5v3.5"></path>
                                </svg>
                                <span>أنواع المدارس المستفيدة</span>
                            </h4>
                            <div class="metric-list">
                                ${data.schoolTypes.map(item => `
                                    <div class="metric-row">
                                        <span>${item.label}</span>
                                        <strong>${formatNumber(item.value)}</strong>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>
                </section>

                <section class="section">
                    <div class="section-header">
                        <div>
                            <div class="section-title title-with-icon">
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M6 12l4 4 8-8"></path>
                                    <path d="M4 7h16"></path>
                                </svg>
                                <span>الالتزام بتطبيقات المدرسة</span>
                            </div>
                            <div class="section-subtitle">نسب تفعيل مدرستي والسلوك والمواظبة والانضباط</div>
                        </div>
                    </div>
                    <div class="compliance-grid">
                        ${data.compliance.map(item => {
                            const total = item.yes + item.no + item.unknown;
                            const yesRate = total ? (item.yes / total) * 100 : 0;
                            return `
                                <div class="compliance-card">
                                    <h4>
                                        <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                            <path d="M5 13l4 4 10-10"></path>
                                        </svg>
                                        <span>${item.label}</span>
                                    </h4>
                                    <div class="compliance-values">
                                        <span class="badge yes">نعم ${formatNumber(item.yes)}</span>
                                        <span class="badge no">لا ${formatNumber(item.no)}</span>
                                        <span class="badge unknown">غير محدد ${formatNumber(item.unknown)}</span>
                                    </div>
                                    <div class="progress"><span style="width: ${yesRate}%;"></span></div>
                                    <div class="compliance-gauge">
                                        <div class="gauge-ring" style="--value: ${yesRate.toFixed(1)};">
                                            <span>${yesRate.toFixed(1)}%</span>
                                        </div>
                                        <div class="gauge-caption">نسبة الالتزام</div>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                </section>

                <section class="section">
                    <div class="section-header">
                        <div>
                            <div class="section-title title-with-icon">
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M4 16h4V8H4z"></path>
                                    <path d="M10 16h4V4h-4z"></path>
                                    <path d="M16 16h4v-6h-4z"></path>
                                </svg>
                                <span>التوزيع حسب المرحلة والقطاعات</span>
                            </div>
                            <div class="section-subtitle">توزيع المدارس وتقارير المشرفين حسب المرحلة والقطاع</div>
                        </div>
                    </div>
                    <div class="cards-grid">
                        <div class="card">
                            <h4>
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M5 20V6l7-3 7 3v14"></path>
                                    <path d="M9 20v-6h6v6"></path>
                                </svg>
                                <span>المرحلة الدراسية</span>
                            </h4>
                            <div class="bar-list">
                                ${buildBarList(data.stageDistribution)}
                            </div>
                        </div>
                        <div class="card">
                            <h4>
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <circle cx="12" cy="12" r="9"></circle>
                                    <path d="M12 3v18"></path>
                                    <path d="M3 12h18"></path>
                                </svg>
                                <span>التوزيع على القطاعات</span>
                            </h4>
                            <div class="bar-list">
                                ${buildBarList(data.sectorDistribution)}
                            </div>
                        </div>
                    </div>
                </section>

                <section class="section">
                    <div class="section-header">
                        <div>
                            <div class="section-title title-with-icon">
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M7 20v-6h10v6"></path>
                                    <path d="M5 9l7-5 7 5"></path>
                                    <path d="M12 9v5"></path>
                                </svg>
                                <span>مشاركة قيادة المدرسة</span>
                            </div>
                            <div class="section-subtitle">مدى مشاركة القيادة في تنفيذ عمليات الدعم</div>
                        </div>
                    </div>
                    <div class="cards-grid">
                        <div class="card">
                            <div class="bar-list">
                                ${buildBarList(data.leadershipParticipation)}
                            </div>
                        </div>
                        <div class="card">
                            <h4>
                                <svg class="title-icon" viewBox="0 0 24 24" aria-hidden="true">
                                    <path d="M4 6h16"></path>
                                    <path d="M4 12h16"></path>
                                    <path d="M4 18h10"></path>
                                </svg>
                                <span>مجالات الدعم المنفذة</span>
                            </h4>
                            <div class="bar-list">
                                ${buildBarList(data.supportFields)}
                            </div>
                        </div>
                    </div>
                </section>

                <div class="footer">
                    تم تحديث البيانات آليًا من ملف التقارير الأسبوعي • جميع الأرقام مستخرجة من قاعدة البيانات المصدرية
                </div>
            `;

            const sectorSelect = document.getElementById('sector-select');
            if (sectorSelect) {
                sectorSelect.addEventListener('change', (event) => {
                    const nextSector = event.target.value;
                    const updatedData = computeAggregates(
                        rows,
                        columns,
                        nextSector,
                        baseData,
                        supervisorRows,
                        supervisorColumns,
                        schoolSupportColumns
                    );
                    renderDashboard(updatedData, rows, columns, baseData, supervisorRows, supervisorColumns, schoolSupportColumns);
                });
            }
        }

        window.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>
